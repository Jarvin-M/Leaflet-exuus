<!DOCTYPE html>
<html>
<head>
    <title>Exuus Leaflet Map</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <style>
    #map{ height: 720px; width:900px; display: block; margin: auto;}
    .info {padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px;}
    .info h4 {margin: 0 0 10px;color: #777;}
    .legend {line-height: 18px;color: #555;}
    .legend i {width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7;}

   
    </style>
</head>
<body>
<ul>
<li>
   <select id="geolevel" onchange="handler();" >
   <option value="">Location </option>
       <option value="a"> Provinces</option>
       <option value="b">Districts</option>
       <option value ="c">Sectors</option>
   </select>
</li>
<li>
    <select id="province" onchange="handler();" >
   <option value="">Provinces </option>
       <option value="aa"> Eastern Province</option>
       <option value="ba">Western Province</option>
       <option value ="ca">Kigali City</option>
       <option value ="da">Northern Province</option>
       <option value ="ea">Southern Province</option>
   </select>
</li>
<li>
    <select id="district" onchange="handler();" >
   <option value="">Districts </option>
       <option value="ab"> Eastern Province</option>
       <option value="bb">Western Province</option>
       <option value ="cc">Kigali City</option>
       <option value ="dc">Northern Province</option>
       <option value ="ec">Southern Province</option>
   </select>
</li>
  </ul> 
<div id="map"></div>

    <script>
    var geojson;
    //var geojsonD;
    //var geojsonS;
    //var geojsonK;
        var map = L.map('map',{zoomControl: true}).setView([-2.0334,29.8993], 8);
       map.zoomControl.setPosition('topright');
        mapLink = 
            '<a href="http://openstreetmap.org">OpenStreetMap</a>';
        L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Map data &copy; ' + mapLink,
            maxZoom: 18,
            minZoom: 9
            }).addTo(map);

      //provinces
        function getColor(d) {
            return d > 5001 ? '#a50f15':
                   d > 4001  ? '#de2d26':
                   d > 3001  ? '#fb6a4a':
                   d > 0  ? '#fcae91': 
                            '#fee5d9';
                }
        function style(feature) {
            return {
                fillColor: getColor(feature.properties.density),
                weight: 2,
                opacity: 10,
                color: 'white',
                dashArray: '3',
                fillOpacity: 10
            };
        }
        
function provinceDisplay(){
    
        if(geojson === undefined){


            $.getJSON("admin4.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: style,
              onEachFeature: onEachFeature
            }).addTo(map);
          });
        } else{
            geojson.eachLayer(function (layer) { map.removeLayer(layer);});
         $.getJSON("admin4.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: style,
              onEachFeature: onEachFeature
            }).addTo(map);
          });
         }
}
        function onEachFeature(feature, layer) {
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight
                
            });
        }
        

        function highlightFeature(e) {
             var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 3
            });


            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }

            info.update(layer.feature.properties);
            
        }

        function resetHighlight(e) {
             geojson.resetStyle(e.target);
            info.update();
        }


        //custom control within the map
         var info = L.control({position:'topleft'});

        info.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        info.update = function (props) {
            this._div.innerHTML = '<h4>Saving groups per Province</h4>' +  (props ?
                '<b>' + props.Name + ' Province</b><br />' + props.density + ' Saving groups'
                : 'Hover over a province');
        };

        

        //legend
        var legend = L.control({position: 'bottomright'});

        legend.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 3001, 4001, 5001],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };

        

        //districts

        function getColorD(d) {
            return d > 2001 ? '#00441b':
                   d > 1001  ? '#006d2c':
                   d > 801  ? '#238b45':
                   d > 601  ? '#41ab5d': 
                   d > 401  ? '#74c476':
                   d > 201  ? '#a1d99b':
                   d > 0  ? '#c7e9c0':
                            '#e5f5e0';
                }
  

        function styleD(feature) {
            return {
                fillColor: getColorD(feature.properties.density),
                weight: 2,
                opacity: 10,
                color: 'white',
                dashArray: '3',
                fillOpacity: 10
            };
        }
 
 function districtDisplay(){
    if(geojson === undefined){
       $.getJSON("District_Rwanda.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleD,
              onEachFeature: onEachFeatureD
            }).addTo(map);
          });
    }
    else{
        geojson.eachLayer(function (layer) { map.removeLayer(layer);});
        $.getJSON("District_Rwanda.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleD,
              onEachFeature: onEachFeatureD
            }).addTo(map);
          });
    }
}
        function onEachFeatureD(feature, layer) {
            layer.on({
                mouseover: highlightFeatureD,
                mouseout: resetHighlightD
                
            });
        }
        

        function highlightFeatureD(e) {
             var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 3
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }

            infoD.update(layer.feature.properties);
        }

        function resetHighlightD(e) {
             geojson.resetStyle(e.target);
            infoD.update();
        }


        //custom control within the map
         var infoD = L.control({position:'topleft'});

        infoD.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        infoD.update = function (props) {
            this._div.innerHTML = '<h4>Saving groups per District</h4>' +  (props ?
                '<b>' + props.Name + ' District</b><br />' + props.density + ' Saving groups'
                : 'Hover over a district');
        };

        

        //legend
        var legendD = L.control({position: 'bottomright'});

        legendD.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 201, 401, 601, 801, 1001, 2001,],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColorD(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };

 

//sectors
function getColorS(d) {
            return d > 141 ? '#7f2704':
                   d > 121  ? '#a63603':
                   d > 101  ? '#d94801':
                   d > 81  ? '#f16913': 
                   d > 61  ? '#fd8d3c':
                   d > 41  ? '#fdae6b':
                   d > 21  ? '#fdd0a2':
                   d > 0  ? '#fee6ce':
                            '#fff5eb';
                }
  
        function styleS(feature) {
            return {
                fillColor: getColorS(feature.properties.density),
                weight: 2,
                opacity: 10,
                color: 'white',
                dashArray: '3',
                fillOpacity: 10
            };
        }
 
        function sectorDisplay(){
            if(geojson  ===  undefined){
            //map.removeLayer(geojson);
           //map.removeLayer(geojsonP);
             $.getJSON("Sector_Rwanda.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleS,
              onEachFeature: onEachFeatureS
            }).addTo(map);

          });
        }else{
            geojson.eachLayer(function (layer) { map.removeLayer(layer);});
           //map.removeLayer(geojsonD);
           //map.removeLayer(geojsonP);
           //geojson.clearLayers();
             $.getJSON("Sector_Rwanda.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleS,
              onEachFeature: onEachFeatureS
            }).addTo(map);

          }); 
        }
             
}
        function onEachFeatureS(feature, layer) {
            layer.on({
                mouseover: highlightFeatureS,
                mouseout: resetHighlightS
                
            });
        }
        

        function highlightFeatureS(e) {
             var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 3
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }

            infoS.update(layer.feature.properties);
        }

        function resetHighlightS(e) {
             geojson.resetStyle(e.target);
            infoS.update();
        }


        //custom control within the map
         var infoS = L.control({position:'topleft'});

        infoS.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        infoS.update = function (props) {
            this._div.innerHTML = '<h4>Saving groups per Sector</h4>' +  (props ?
                '<b>' + props.Name + ' Sector</b><br />' + props.density + ' Saving groups'
                : 'Hover over a Sector');
        };

        

        //legend
        var legendS = L.control({position: 'bottomright'});

        legendS.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 21, 41, 61, 81, 101, 121,141],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColorS(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };

 //Kigali City
 function getColorK(d) {
            return d > 601  ? '#a63603':
                   d > 401  ? '#d94801':
                   d > 201  ? '#f16913': 
                   d > 0  ? '#fd8d3c':
                            '#fff5eb';
                }
  
        function styleK(feature) {
            return {
                fillColor: getColorK(feature.properties.density),
                weight: 2,
                opacity: 10,
                color: 'white',
                dashArray: '3',
                fillOpacity: 10
            };
        }
 
        function kigaliDisplay(){
            if(geojson ===  undefined ){

             $.getJSON("Kigali_geojson.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleK,
              onEachFeature: onEachFeatureK
            }).addTo(map);
          });

         }
         else{
            geojson.eachLayer(function (layer) { map.removeLayer(layer);});

            $.getJSON("Kigali_geojson.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleK,

              onEachFeature: onEachFeatureK
            }).addTo(map);
          });
         }
}
        function onEachFeatureK(feature, layer) {
            layer.on({
                mouseover: highlightFeatureK,
                mouseout: resetHighlightK
                
            });
        }
        

        function highlightFeatureK(e) {
             var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 3
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }

            infoK.update(layer.feature.properties);
        }

        function resetHighlightK(e) {
             geojson.resetStyle(e.target);
            infoK.update();
        }


        //custom control within the map
         var infoK = L.control({position:'topleft'});

        infoK.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        infoK.update = function (props) {
            this._div.innerHTML = '<h4>Saving groups in Kigali</h4>' +  (props ?
                '<b>' + props.Name + ' District</b><br />' + props.density + ' Saving groups'
                : 'Hover over a District');
        };

        

        //legend
        var legendK = L.control({position: 'bottomright'});

        legendK.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 201, 401, 601],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColorK(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };

//northern province
        function getColorN(d) {
            return d > 901  ? '#a63603':
                   d > 601  ? '#d94801':
                   d > 301  ? '#f16913': 
                   d > 0  ? '#fd8d3c':
                            '#fff5eb';
                }
  
        function styleN(feature) {
            return {
                fillColor: getColorN(feature.properties.density),
                weight: 2,
                opacity: 10,
                color: 'white',
                dashArray: '3',
                fillOpacity: 10
            };
        }
 
        function northDisplay(){
            if(geojson ===  undefined ){

             $.getJSON("Northern_Province.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleN,
              onEachFeature: onEachFeatureN
            }).addTo(map);
          });

         }
         else{
            geojson.eachLayer(function (layer) { map.removeLayer(layer);});

            $.getJSON("Northern_Province.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleN,
              onEachFeature: onEachFeatureN
            }).addTo(map);
          });
         }
}
        function onEachFeatureN(feature, layer) {
            layer.on({
                mouseover: highlightFeatureN,
                mouseout: resetHighlightN
                
            });
        }
        

        function highlightFeatureN(e) {
             var layer = e.target;
            geojson.setStyle({weight: 7,color: 'rgba(0,0,0,0)'});
            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 3
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }

            infoN.update(layer.feature.properties);
        }

        function resetHighlightN(e) {
             geojson.resetStyle(e.target);
            infoN.update();
        }


        //custom control within the map
         var infoN = L.control({position:'topleft'});

        infoN.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        infoN.update = function (props) {
            this._div.innerHTML = '<h4>Saving groups in Northern Province</h4>' +  (props ?
                '<b>' + props.Name + ' District</b><br />' + props.density + ' Saving groups'
                : 'Hover over a District');
        };

        

        //legend
        var legendN = L.control({position: 'bottomright'});

        legendN.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 201, 401, 601],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColorN(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };

//southern Province
        function getColorSN(d) {
            return d > 2001 ? '#7f2704':
                   d > 1501 ? '#a63603':
                   d > 1001 ? '#d94801':
                   d > 501  ? '#f16913': 
                   d > 0  ? '#fd8d3c':
                            '#fff5eb';
                }
  
        function styleSN(feature) {
            return {
                fillColor: getColorSN(feature.properties.density),
                weight: 2,
                opacity: 10,
                color: 'white',
                dashArray: '3',
                fillOpacity: 10
            };
        }
 
        function southDisplay(){
            if(geojson ===  undefined ){

             $.getJSON("Southern_Province.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleSN,
              onEachFeature: onEachFeatureSN
            }).addTo(map);
          });

         }
         else{
            geojson.eachLayer(function (layer) { map.removeLayer(layer);});

            $.getJSON("Southern_Province.geojson",function(rwandaData){
            geojson = L.geoJson( rwandaData, {
              style: styleSN,
              onEachFeature: onEachFeatureSN
            }).addTo(map);
          });
         }
}
        function onEachFeatureSN(feature, layer) {
            layer.on({
                mouseover: highlightFeatureSN,
                mouseout: resetHighlightSN
                
            });
        }
        

        function highlightFeatureSN(e) {
             var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 3
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }

            infoSN.update(layer.feature.properties);
        }

        function resetHighlightSN(e) {
             geojson.resetStyle(e.target);
            infoSN.update();
        }


        //custom control within the map
         var infoSN = L.control({position:'topleft'});

        infoSN.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        infoSN.update = function (props) {
            this._div.innerHTML = '<h4>Saving groups in Southern Province</h4>' +  (props ?
                '<b>' + props.Name + ' District</b><br />' + props.density + ' Saving groups'
                : 'Hover over a District');
        };

        

        //legend
        var legendSN = L.control({position: 'bottomright'});

        legendSN.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 201, 401, 601],
                labels = [];

            // loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColorSN(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };
//onclick handlers
        
    function handler(){

        if (document.getElementById('geolevel').value == 'a'){
            provinceDisplay();
             map.removeControl(legendD);
             map.removeControl(infoD);
             map.removeControl(legendS);
             map.removeControl(infoS);
                  legend.addTo(map);
                  info.addTo(map); 
        }
        else if (document.getElementById('geolevel').value == 'b'){
            districtDisplay();
           map.removeControl(legend);
             map.removeControl(info);
             map.removeControl(legendS);
             map.removeControl(infoS);
             legendD.addTo(map);
                     infoD.addTo(map); 
        }
        else if (document.getElementById('geolevel').value == 'c'){
            sectorDisplay();   
             //map.eachLayer(function (layer) { map.removeControl(layer);});    
           map.removeControl(legend);
             map.removeControl(info);
             map.removeControl(legendD);
             map.removeControl(infoD);
                     legendS.addTo(map);
                     infoS.addTo(map); 
        }else if (document.getElementById('province').value == 'ca'){
            //window.location.replace();
            kigaliDisplay();
           map.removeControl(legendN);
             map.removeControl(infoN);
                     legendK.addTo(map);
                     infoK.addTo(map); 
        }else if (document.getElementById('province').value == 'da'){
            
            northDisplay();
           map.removeControl(legendK);
             map.removeControl(infoK);
                     legendN.addTo(map);
                     infoN.addTo(map); 
        }else if (document.getElementById('province').value == 'ea'){
            
            southDisplay();
           map.removeControl(legendK);
             map.removeControl(infoK);
                     legendSN.addTo(map);
                     infoSN.addTo(map); 
        }

    }
    </script>
</body>
</html>